
Note

A note on the conversion of orbital angles for

extreme mass ratio inspirals

Philip Lynch

Max Planck Institute for Gravitational Physics (Albert Einstein Institute),

Potsdam-Golm, Germany

E-mail: philip.lynch@aei.mpg.de

Ollie Burke

Laboratoire des 2 Infinis – Toulouse (L2IT-IN2P3), Universitè de Toulouse, CNRS,

UPS, F-31062 Toulouse Cedex 9, France

Abstract. We outline a practical scheme for converting between three commonly

used sets of phases to describe the trajectories of extreme mass ratio inspirals; quasi-

Keplerian angles, Mino time action-angles, and Boyer-Lindquist time action-angles

(as utilised by the FastEMRIWaveform package). Conversion between Boyer-Lindquist

time action angles and quasi-Keplerian angles is essential for the construction of a

source frame for adiabatic inspirals that can be related to the source frames used by

other gravitational wave source modelling techniques. While converting from quasi-

Keplerian angles to Boyer-Lindquist time action angles via Mino time action-angles can

be done analytically, the same does not hold for the converse, and so we make use of

an efficient numerical root-finding method. We demonstrate the efficacy of our scheme

by comparing two calculations for an eccentric and inclined geodesic orbit in Kerr

spacetime using two different sets of orbital angles. We have made our implementations

available in Mathematica, C, and Python.

Keywords: Gravitational Waves, Black Hole Binaries, Extreme Mass Ratio Inspirals,

Celestial Mechanics

Submitted to: Class. Quantum Grav.

ar
X

iv
:2

41
1.

04
95

5v
1 

 [
gr

-q
c]

  7
 N

ov
 2

02
4



On the conversion of orbital angles for extreme mass ratio inspirals 2

1. Introduction

With the advent of space-based gravitational wave (GW) detectors, such as the recently

adopted Laser Interferometer Space Antenna (LISA), comes the need to produce highly

accurate waveforms for gravitational wave (GW) sources in the millihertz frequency

band [1,2]. One major source of interest are systems consisting of a massive black hole

(MBH) primary of mass m1 ∼ 105 − 107M⊙ and a compact object (CO) secondary,

such as a stellar mass black hole or neutron star, of mass m2 ∼ 1− 102M⊙ resulting in

a binary with mass ratio q = m2/m1 ∼ 10−3 − 10−7. The binary slowly loses energy

and angular momentum due to the emission of GWs, which causes the secondary to

eventually spiral into the primary. The result of this is a GW signal that will be present

in the sensitivity band of LISA for months to years. These binary systems are known as

extreme mass ratio inspirals (EMRIs) and are expected to be a key GW source for the

LISA space mission. The trajectory of the smaller body will be highly relativistic, long-

lasting and exceedingly complicated with respect to more comparable mass systems (see

[3] and references within). Astrophysical formation channels suggest that the orbits will

be both moderately eccentric and inclined with respect to the equatorial plane of the

rotating primary black hole [4]. The result of these orbits is a phenomenologically rich

waveform [5] with features that strongly depend on the central black hole’s parameters

– mass and Kerr rotation parameter. If modelled correctly, EMRI observations using

LISA would provide unrivalled precision measurements on the astrophysical parameters

that govern the system and our most stringent tests on Einstein’s theory of General

Relativity thus far [6–10].

At leading order, one can approximate the system as a test particle following

a bound, timelike geodesic in a black hole spacetime, such as Schwarzschild (non-

rotating) or Kerr (rotating). To account for the emission of GWs, one can describe

change of energy, angular momentum and Carter constant of the binary using so-

called “flux-balance formulae” [11,12] in what is known as the adiabatic approximation

(0PA) [5, 13–19]. Going beyond this level of accuracy requires additional knowledge

of the local force acting on the test particle, which causes deviations from geodesic

motion due to the COs own gravitational field, known as the gravitational self-force

(GSF) (see reviews [20, 21] and and references within). The dynamics of the CO

in the presence of the massive black hole can be accurately described using the two-

timescale procedure [22,23], where both the action and angle variables are presented as

a perturbative expansion in the small mass-ratio q. It has been shown that in order to

accurately track the phase evolution of a true vacuum GR based EMRI waveform to

sub-radian accuracy, we require knowledge of the dissipative piece of the second-order

GSF [24–27] It is thus both necessary, and sufficient to have these expansions known

and correct to not only adiabatic (0PA) but post-adiabatic (1PA) order [28].

One method for constructing the inspiral trajectory from the GSF assumes that

the inspiral can be modelled as a series of instantaneously tangent geodesic orbits. This

is known as the method of osculating geodesics and is described further in [7, 29]. This



On the conversion of orbital angles for extreme mass ratio inspirals 3

method is often too slow to be used on its own due to the need to accurately track

O(q−1) orbital oscillations. Thus this method is coupled with averaging procedures

such as near-identity (averaging) transformations (NITs) [30–36] or a two-timescale

expansion [22,23,34] to accelerate the trajectory calculation. This all relies on a robust

understanding of the leading-order, geodesic motion of the system.

Eccentric and inclined geodesics within the Kerr spacetime are tri-periodic and

simultaneously display radial, polar, and azimuthal motion [37]. Many works have

thoroughly explored and described these orbits, but the choice of orbital phases used to

describe the motion are not unique. One popular choice takes inspiration from Keplerian

mechanics. The “eccentric anomaly”, ψ, was first used to describe eccentric orbits in

Schwarzschild spacetimes [38] and a polar counterpart, χ, was later constructed for

circular and inclined orbits in Kerr spacetimes [13]. These phases have the advantage of

having very simple relations to the radial and polar Boyer-Lindquist (BL) coordinates

of the secondary, resulting in their widespread use to describe inspiral trajectories

[7, 29, 35, 39–41]. However, the evolution equations for these phases do not have known

closed form solutions for geodesic orbits and have to be solved numerically. For this work,

we refer to this set along with the azimuthal BL coordinate ϕ as the “quasi-Keplerian”

(QK) angles.

Another choice was made possible by using (Carter-) Mino time (MT) λ which

decouples the radial and polar geodesic equations [42], allowing for analytic expressions

in terms of Jacobi-elliptic integrals for the radial and polar BL coordinates in terms of

Mino Time action-angles (MTAAs) [43]. The resulting expressions for the coordinates

are more complicated than the QK ones. However, the rate of change of these phases

with respect to Mino time are exactly the Mino time fundamental frequencies Υi. Since

these frequencies are constants of motion they are preferable to the QK angles when

constructing NIT equations of motion for generic Kerr orbits [32–34,36].

Finally, one can also describe the motion in terms of Boyer-Lindquist time action-

angles (BLAAs) or “true anomaly” angles. These angles have no known analytic relation

to the BL coordinates of the secondary. However, their rate of change of these phases

with respect to BL time t is exactly the BL time fundamental frequencies Ωi [44]. The

BL time coordinate is easily related to the time coordinate of the detector. As such,

these AAs are very convenient for constructing efficient adiabatic EMRI waveforms via

the multi-voice decomposition [17] and are the angles utilised in the FastEMRIWaveforms

(FEW) package [44–46] as well as in some NIT inspiral calculations [34,47]. Furthermore,

these phases underlie the multi-scale analysis of the Einstein field equations needed to

obtain 1PA results [23].

The ability to relate these various angles together is very important as being able to

relate the outputs of trajectory calculations computed using different parameterisations

provides a useful method of validation. Having a practical scheme to relate the BLAAs

to the BL coordinates of the secondary would allow both for visualisations of 0PA

inspirals. Moreover, it would allow one to construct the EMRI source frame (at 0PA

accuracy) which can be converted to other frame choices as utilised by other LISA source



On the conversion of orbital angles for extreme mass ratio inspirals 4

Figure 1: Schematic description of the analytical and numerical conversions between

different sets of orbital angles as described in this note.

modelling approaches [48].

Conversions between all these angles are known, but only in the form of Fourier

decompositions that are not very practical to work with [37]. An analytic transformation

between QK angles and BL time AAs has been found for eccentric Schwarzschild orbits

but relies on a small eccentricity expansion [49]. More tractable relationships between

the MTAAs and BLAAs for generic inspirals have been found [21] and implemented

[34,47].

This note looks to complete the picture by describing practical conversions between

these three sets of orbital phases for generic Kerr orbits, as displayed in Fig. 1. We begin

by outlining how one can analytically convert back and forth between QK angles and

MTAAs in Sec. 3.1. We then show how one can find an analytic conversion from the

MTAAs to the BLAAs, and how one can leverage a numerical root-finding scheme

to invert this relationship in Sec. 3.2. With this in hand, it is then straightforward

to convert from BLAAs to QK angles via the MTAAs, as described in Sec. 3.3. We

demonstrate our methods in Sec. 4 by comparing between two different calculations

for the same eccentric and inclined Kerr geodesic. We have made these transformations

public as part of the KerrOrbitalAngleConversion Github repository [50] and they will

soon be implemented as part of the FEW package and the KerrGeodesics Mathematica

package [51].

2. Geodesics in Kerr spacetime

2.1. Constants of Motion

We denote the mass of the primary black hole by m1 and parameterise the black hole’s

rotation by a = |J |/m1 where J is the angular momentum of the black hole. The Kerr

metric can then be written in modified BL coordinates, xα = (t, r, z = cos θ, ϕ), as

ds2 =−
(
1− 2m1r

Σ

)
dt2 +

Σ

∆
dr2 +

Σ

1− z2
dz2

+
1− z2

Σ
(2a2r(1− z2) + Σϖ2)dϕ2 − 4m1ar(1− z2)

Σ
dtdϕ

(1)



On the conversion of orbital angles for extreme mass ratio inspirals 5

where

∆(r) := r2 + a2 − 2m1r, Σ(r, z) := r2 + a2z2, ϖ(r) :=
√
r2 + a2, (2a-c)

In the absence of any perturbing force, the secondary will follow a geodesic, i.e.,

uβ∇βu
α = 0. The symmetries of the Kerr spacetime allow for the identification of

integrals of motion P⃗ = (E ,L,K) given by

E = −ut, L = uϕ, K = Kαβuαuβ, (3a-c)

where Kαβ is the Killing tensor, E is the orbital energy per unit rest mass m2, L is the

z-component of the angular momentum divided by m2 and K is the Carter constant

divided by m2
2 [52]. This definition of the Carter constant is related to another common

definition of the Carter Constant via Q = K − (L − aE)2. Using these integrals of

motion, one can express the geodesic equations in first order, decoupled form [37]:(
dr

dλ

)2

= B2 −∆
(
r2 +K

)
= (1− E2)(ra − r)(r − rp)(r − r3)(r − r4) := Vr,

(4a)

(
dz

dλ

)2

= Q− z2
(
β(1− z2) + L2 +Q

)
= (z2 − z2−)

(
βz2 − z2+

)
:= Vz,

(4b)

dt

dλ
=
ϖ2

∆
B − a2E(1− z2) + aL := ft, (4c)

dϕ

dλ
=

a

∆
B +

L
1− z2

− aE := fϕ, (4d)

where B = Eϖ2 − aL, β = a2(1− E2). The roots of the radial potential Vr are denoted

ra > rp > r3 > r4 where the radial motion of the secondary is confined between the

radius of apastron ra and the radius of periastron rp. Similarly, the roots of the polar

potential Vz are denoted z+ > z− where the polar motion of the secondary is bounded

between z− and −z−. Finally, note that we are making use of Mino(-Carter) time λ so

that we may decouple the radial and polar equations [42]. This time is related to the

proper time of the particle, τ , by dτ = Σdλ.

Rather than parameterise an orbit by the set P⃗ = (E ,L,K) it is useful to instead

use more geometric, quasi-Keplerian constants P⃗ = (p, e, xI). Here p is the semi-latus

rectum and e is the orbital eccentricity which are both related to ra and rp via:

p =
2rarp
ra + rp

and e =
ra − rp
ra + rp

. (5a-b)

We also use xI which is a measure of the orbital inclination given by

xI = cos I =
√

1− z2−, (6)



On the conversion of orbital angles for extreme mass ratio inspirals 6

Figure 2: A illustration of the radial and polar motion present for generic Kerr orbits.

The graph shows how the motion fills a torus which is bounded by the radial roots ra
and rp and the value of the polar root z−. This illustration was taken from [5] with

minor alterations.

where xI = 1 corresponds to pro-grade equatorial motion and xI = −1 corresponds to

retrograde equatorial motion. The inclination angle I is related to θmin (the minimum

value of θ measured with respect to the primary’s spin axis) by I = π/2 − sgn(L)θmin.

These angles and their relationship to each other are illustrated in Fig. 2‡.
We opt to use P⃗ as they are easily related to the radial and polar roots via

ra =
p

1− e
, rp =

p

1 + e
, z− =

√
1− x2I . (7a-c)

One can also determine expressions for P⃗ in terms of (ra, rp, z−) and thus in terms of

P⃗ as was done in Ref. [44]. With these expressions in hand, one can determine the

remaining roots of the radial and polar potentials via

r3 =
m1

1− E2
− ra + rp

2
+

√(
ra + rp

2
− m1

1− E2

)2

− a2Q
r1r2(1− E2)

(8a)

r4 =
a2Q

rarpr3(1− E2)
, (8b)

z+ =

√
β +

L2

x2I
. (8c)

As such, given values for P⃗ , we can determine all of the other constants that appear in

the geodesic equations of motion.

‡ The 5PN Augmented Analytic Kludge model in FEW uses a different definition of inclination given

by Y = cos ι = L/
√
L2 +Q. The conversion from xI to Y is trivial and a function to numerically

convert from Y to xI is provided in the FEW package [45].



On the conversion of orbital angles for extreme mass ratio inspirals 7

2.2. Quasi-Keplerian parameterisation

We note that it is also common in the literature [7, 37] to express the radial and polar

motion in terms of quasi-Keplerian angles§, ψ and χ, via

r(ψ) =
p

1 + e cosψ
and z(χ) = z− cosχ. (9a-b)

With this parameterisation, the evolution equations for ψ and χ depend on ψ and χ

respectively i.e.,

dψ

dλ
=

1

1− e2

√
(1− E2) ((p− p3)− e(p+ p3 cosψ)) ((p− p4) + e(p− p4 cosψ)) := fr(ψ),

(10a)

dχ

dλ
=

√
(z2+ − βz2− cos2 χ) := fθ(χ), (10b)

where p3 = r3(1− e) and p4 = r4(1 + e) [37]. These evolution equations currently have

no known closed form solution and so are typically solved numerically.

2.3. Mino time action angle parametrisation

In the action angle prescription of the geodesic motion, the orbital phases q⃗ =

(qt, qr, qθ, qϕ) are such that the geodesic equations can written in the form

dPj
dλ

= 0 and
dqi
dλ

= Υi(P⃗ ), (11a-b)

where Υi(P⃗ ) are the Mino time fundamental frequencies which have analytic expressions

first derived in Ref. [43]. From the geodesic equations of motion, the solutions for P⃗ (λ)

and q⃗i(λ) are simply given by

Pj(λ) = Pj,0 and qi = Υi(P⃗0)λ+ qi,0, (12a-b)

where Pj,0 and qi,0 are the initial values at λ = 0.

Using the expressions derived in Ref. [43] and then simplified in Ref. [54], one can

express the radial and polar BL coordinates of a test particle under geodesic motion via

r(qr) =
r3(ra − rp)sn

2
(
K(kr)
π
qr|kr

)
− rp(ra − r3)

(ra − rp)sn2
(
K(kr)
π
qr|kr

)
− (ra − r3)

, (13a)

z(qθ) = z−sn

(
K(kz)

2(qθ +
π
2
)

π
|kz

)
, (13b)

§ These are not the only Keplerian inspired angles that exist in the literature. See for example Ref. [53]

for their construction and conversions to other sets of angles.



On the conversion of orbital angles for extreme mass ratio inspirals 8

where

kr =
(ra − rp)(r3 − r4)

(ra − r3)(rp − r4)
, and kz = β

z2−
z2+
. (14a-b)

Here, K is complete elliptic integral of the first kind given by K(m) = F (π/2|m) and

F is the incomplete elliptic integral of the first kind given by

F (ϕ|m) :=

∫ ϕ

0

dθ√
1−m sin2 θ

. (15)

The inverse of this function is the Jacobi amplitude am i.e. if u = F (ϕ|m), then

ϕ = am(u|m). Thus Jacobi elliptic sine function sn given by sn(u|m) = sin(am(u|m)).

Furthermore, we have adopted the convention that qr = 0 corresponds to the periapsis

of the radial motion (i.e. r = rp), and qθ = 0 corresponds to the maximum value of the

polar BL coordinate z (i.e. z = z−).

Ref. [43] also derived analytic solutions for the Boyer-Lindquist time and azimuthal

geodesic equations, (4c) and (4d), however these expressions are lengthy and so will only

be written schematically here as:

t(λ) = qt + δt(qr, qθ) = Υtλ+ qt,0 + tr(qr) + tθ(qθ), (16a)

ϕ(λ) = qϕ + δϕ(qr, qθ) = Υϕλ+ qϕ,0 + ϕr(qr) + ϕθ(qθ), (16b)

where we use δf to denote that a function is 2π periodic in its arguments and has an

orbit average of zero, and tr\ϕr and tθ\ϕθ are oscillatory functions that depend solely

on the radial and polar phases respectively. For this work, we choose the convention

that qt,0 = 0.

2.4. Boyer-Lindquist time action angle parameterisation

We note that the Mino time fundamental frequencies (Υt,Υr,Υz,Υϕ) do not have a

physical interpretation by themselves. However, the frequencies observed at infinity,

i.e., the BL time fundamental frequencies Ω⃗ = (Ωr,Ωθ,Ωϕ), are given by

Ωr =
Υr

Υt

, Ωz =
Υz

Υt

, Ωϕ =
Υϕ

Υt

. (17a-c)

From these, one can define a new set of action angles associated with the BL time

coordinate that, for geodesics, follow the equations of motion:

dPj
dt

= 0 and
dΦi

dt
= Ωi(P⃗ ). (18a-b)

These have the solutions

Pj(t) = Pj,0 and Φi = Ωi(P⃗ (0))t+ Φi,0, (19a-b)

where Pj,0 and Φi,0 are the initial values at t = 0.



On the conversion of orbital angles for extreme mass ratio inspirals 9

3. Angle Conversions

3.1. Quasi-Keplerian to Mino-time action angles

We now seek to establish a practical method to relate the various different phases to

one another. We start by relating the radial QK angle ψ to the radial MTAA qr. Using

(9) and (13a), we can equate the analytic solutions for the radial BL coordinate r, i.e.,

r(ψ) = r(qr) to obtain

ψ(qr) = arccos

(
p− r(qr)

er(qr)

)
, (20a)

qr(ψ) =
πF (arcsin(kψ(ψ))|kr)

K(kr)
. (20b)

Here kψ =
√

(r(ψ)−rp)(ra−r3)
(r(ψ)−r3)(ra−rp) . While this relationship appears to break down for circular

orbits where e = 0, we show in Appendix A.1 that lime→0 qr = ψ and vice versa.

Similarly, one can relate the polar QK angle χ to the polar MTAA qθ by equating

z(ψ) = z(qθ), which gives us

χ(qθ) = arccos

(
z(qθ)

z−

)
, (21a)

qθ(χ) =
π

2
− πF (arcsin(cosχ)|kz)

2K(kz)
. (21b)

This conversion appears to break down in the equatorial plane when z− = 0. However,

in Appendix A.2 we show that that lime→0 qθ = χ and vice versa.

Note that our conversions rely on the use of functions arccos and arcsin where

most numerical implementations return values in the ranges [0, π] and [−π/2, π/2]
respectively. This is at odds with our use-case where we treat these phases as

monotonically increasing quantities. As such, when we take in a phase φ, we first

identify the “bulk” (B) of the angle given by B = φ − (φ mod 2π). We then use the

appropriate formula above on φ mod 2π to get φconv’d which will have a value between 0

and π. If φ mod 2π ≤ π, we assign the value of the remainder (R) to be R = φconv’d and

if φ mod 2π > π, we assign R = 2π−φconv’d. Our final output is then B+R, resulting

in a conversion that preserves the monotonically increasing nature of the phases.

With these conversions in place for the radial and polar phases, converting between

the azimuthal phases ϕ and qϕ can be straightforwardly done using Eq. (16b). Similarly,

one can relate the BL time coordinate t to qt using Eq. (16a).

3.2. Mino-time action angles to Boyer-Lindquist action angles

We now look to convert between the MTAAs q⃗ = (qr, qθ, qϕ) and the BLAAs Φ⃗ =

(Φr,Φθ,Φϕ). Without loss of generality, we assume that at λ = 0 the orbit starts at

r = rp and θ = θ− and thus choose initial conditions such that qi,0 = Φi,0 = 0. Inserting

Eq. (16a) into Eq. (19b) and recalling Eqs. (17) and Eq. (12,b), one obtains

Φi = Ωi (Υtλ+ δt) = Υiλ+ Ωiδt = qi + Ωiδt. (22)



On the conversion of orbital angles for extreme mass ratio inspirals 10

One can then use the above equation to determine the BLAA initial conditions Φi,0 if

given any other MTAA initial conditions qi,0.

Unfortunately, there is no way to analytically invert this relationship to convert

from Φr and Φθ to qr and qθ for two reasons. Firstly, the radial and polar equations in

BL time are coupled. Secondly, even in the limits where these equations decouple, such

as the circular orbit limit and the equatorial plane, we are left with a more complicated

version of the Kepler equation which is known to have no closed form solution for its

inverse except for infinite series expansions. The most practical approach is to chose our

initial estimate to be qr ∼ Φr and qθ ∼ Φθ and then use an iterative root-finding method

on the coupled system of Eqs. (22) to numerically find the solutions for qr(Φr,Φθ) and

qθ(Φr,Φθ). With these numerical solutions in hand, one can then freely convert between

the two azimuthal phases using:

qϕ = Φϕ − Ωϕδt(qr(Φr,Φθ), qθ(Φr,Φθ)). (23)

3.3. Quasi-Keplerian to Boyer-Lindquist action angles

Finally, if one wishes to convert from QK angles (ψ, χ, ϕ) to BLAAs (Φr,Φθ,Φϕ), one

can do so analytically. First, one uses Eqs. (20b), (21b), and (16b) to obtain values for

the MTAAs (qr, qθ, qϕ). Using these, one can then use Eqs. (22) to obtain values for

(Φr,Φθ,Φϕ).

As mentioned in the previous section, there is not an analytic conversion to go

from (Φr,Φθ,Φϕ) back to (ψ, χ, ϕ). We opt to use a root finding method on Eqs. (22) to

numerically find values for qr and qθ and then use these values with Eq. (23) to obtain

qϕ. Finally we use Eqs. (20a), (21a), and (16b) to obtain our final values of (ψ, χ, ϕ).

We have developed practical implementations of these schemes which can be used in

Wolfram language (Mathematica), C, and Python (using Cython) and have been made

available via the KerrOrbitalAngleConversion Github Repository [50]. In Mathematica,

we make use of the FindRoot function, while in C we use the root-finding scheme present

in the GNU Scientific Library [55].

4. Results

To demonstrate our conversion scheme, we will evolve a geodesic trajectory with

orbital parameters (a, p, e, xI) = (0.9, 7, 0.5, 0.75) and initial conditions (ψ0, χ0, ϕ0) =

(2.7, 1.8.0.9). We will evolve this system from t = 0 to t = 3000m1 using two independent

methods. First, by using a 4th order Runge-Kutta scheme, we numerically solve for the

quasi-Keplerian (QK) phases (ψ(t), χ(t), ϕ(t)) which obey

dψ

dt
=
fr
ft
,

dχ

dt
=
fθ
ft
, and

dϕ

dt
=
fϕ
ft
, (24a-c)

with forcing functions (ft, fϕ, fr, fθ) given by equations (4c), (4d) and sub-equations

(10) respectively. Secondly, we solve for Boyer-Lindquist actions angles (AA)



On the conversion of orbital angles for extreme mass ratio inspirals 11

0 200 400
Time(t/m1)

2

4

6

8

10

12

14

16
QK

AA
r
AA

QK
r

(a) Radial Phases

0 200 400
Time(t/m1)

5

10

15

20 QK

AA

AA

QK

(b) Polar Phases

0 200 400
Time(t/m1)

0

5

10

15

20 QK

AA

AA

QK

(c) Azimuthal Phases

Figure 3: The orbital phases for the first 500m1 of a geodesic trajectory with

orbital parameters (a, p, e, xI) = (0.9, 7, 0.5, 0.75) and initial conditions (ψ0, χ0, ϕ0) =

(2.7, 1.8, 0.9), produced by two independent methods. The QK angles (ψ(t), χ(t), ϕ(t))

oscillate with time, while the BLAAs evolve monotonically. By using the angle

conversions developed in Sec. 3.3, we see that the two methods agree to a high degree

of accuracy.

(Φr(t),Φθ(t),Φϕ(t)) analytically via Eqs. (19). We then use the conversions between

the QK and BL time AA angles described in Sec. 3.3 to compare the solutions for the

two sets of angles and access the accuracy of the conversions.

All timings reported are for the Cython bindings applied to the C implementation

as run in a Jupyter Notebook on a single core of a Mac M1 chip. We find that performing

a single conversion from the QK initial conditions to the AA initial conditions with the

absolute error tolerance of the root-finder set to 10−10, takes ∼ 0.2 ms, while the inverse

transformation only takes ∼ 0.07 ms. Comparing the inverse to the original shows that

that the error is consistent with the tolerance of the root-finder.

Numerically solving Eqs. (24) with relative and absolute accuracy tolerances set to

10−13 takes ∼ 160 ms and 4445 time-steps. As seen in Fig. 3, the numerical solver has

to resolve the orbital oscillations in the solutions for the QK phases which requires small

timesteps. By contrast, solving the AA system analytically is significantly faster (only

∼ 0.5 ms). However, the conversion from AA to QK phases applied at each time-step

takes ∼ 450 ms, whereas converting from QK to AA phases at each time-step only

takes ∼ 60ms. So while it is faster to numerically solve the evolution equations for QK

phases than to construct them from the analytic solutions for the AAs, for waveform

production where speed is essential, it is the AA solutions that are more valuable.

The differences between the final solutions for both (ψ(t), χ(t), ϕ(t)) and

(Φr(t),Φθ(t),Φϕ(t)) from the two methods is displayed in Fig. 4. As we can see in

Fig. 4a, the conversion from AA to QK phases introduces a time independent error of

≲ 10−10 which is consistent with the error of the numerical solver of 10−10. The error on

the action angles however is much smaller ≲ 10−11 as one does not need to numerically



On the conversion of orbital angles for extreme mass ratio inspirals 12

0 500 1000 1500 2000 2500 3000
Time(t/m1)

10 15

10 14

10 13

10 12

10 11

10 10

10 9

Ab
so

lu
te

 D
iff

er
en

ce

(a) Difference in (ψ(t), χ(t), ϕ(t))

0 500 1000 1500 2000 2500 3000
Time(t/m1)

10 15

10 14

10 13

10 12

10 11

10 10

10 9

Ab
so

lu
te

 D
iff

er
en

ce

r

(b) Difference in (Φr(t),Φθ(t),Φϕ(t))

Figure 4: The differences in the phases due to our two methods for solving for a geodesic

trajectory. The QK angles have a time independent difference that is consistent with

the tolerance of the numerical root-finder used in the conversion. The BLAAs have an

difference that is consistent with the tolerances set on the numerical ODE solver which

grows over time.

root-find. While the error is consistent with the tolerances on the numerical ODE solver,

the error grows over time. This means that for long enough trajectories, it would be

more accurate to use the analytical solutions for the AAs which are exact and utilise the

numeric conversion with a constant error, than to numerically solve for the QK phases

and use the analytic conversion to AAs.

From both of these approaches, one can visualise the trajectory like in Fig. 5. To

do this, one must first obtain the solutions for (ψ(t), χ(t), ϕ(t)). From these, one can

use Eqs. (9) along with θ = arccos(z) to find solutions for the BL coordinates of the

secondary with time (r(t), θ(t), ϕ(t)). One can then construct Cartesian-like coordinates

(xC(t), yC(t), zC(t)) via the transformation:

xC(t) = r(t) sin θ(t) cosϕ(t), yC = r(t) sin θ(t) sinϕ(t), and zC = r(t) cos θ(t).

(25a-c)

This allows us to create trajectory visualisations directly from the solutions for the

BLAAs which agree with the results obtained via the QK angles. It also allows us to

construct a vector pointing from the origin (centred on the primary) to the position of

the secondary at a reference time t0 by n(t0) = (xC(t0), yC(t0), zC(t0)). This is necessary

to construct the source frame used by 0PA inspiral calculations [48].

5. Discussion

In this note, we have presented a practical scheme for converting between the various

sets of orbital angles used to describe both geodesic and inspiral trajectories in the Kerr



On the conversion of orbital angles for extreme mass ratio inspirals 13

15
10

5
0

5
10

15

xC/m1
15

10
5

0
5

10
15

yC/m1

15

10

5

0

5

10

15

z C
/m

1

Quasi-Keplerian
Action Angle

Figure 5: A visualisation of a geodesic trajectory with orbital parameters (a, p, e, xI) =

(0.9, 7, 0.5, 0.75) and initial conditions (ψ0, χ0, ϕ0) = (2.7, 1.8, 0.9) evolved for 3000m1

using both the QK angles and the BLAAs.

spacetime. This includes an analytic conversion from QK angles (ψ, χ, ϕ) to MTAAs

(qr, qz, qϕ, qt) and BLAAs (Φr,Φθ,Φϕ) in terms of Jacobi elliptic integrals. While there

is also an analytic conversion from MTAAs back to QK angles, there is no analytic

conversion from BLAAs back to MTAAs. Instead we are forced to use an efficient root-

finding scheme to invert this relationship. While more expensive and less accurate than

the other analytic conversions presented here, this is still the most practical method to

obtain MTAAs and QK angles starting from BLAAs. Utilising Eqs. (20), (21), (22),

and (23), one can relate the output of inspiral calculations that use BLAAs (such as

the FEW package) to the BL coordinates of the secondary. Not only does this allow one

to construct visualizations of the inspiral, but also the construction of the source frame

for 0PA inspirals. This can be converted to other frame choices as used by other GW

source modelling approaches [48].

We demonstrate the accuracy and computational cost of these conversions by

computing a geodesic trajectory using QK angles and BLAAs and using the conversions

presented here to ensure agreement between the two. We find that one can invert

the equations to within an absolute error in the phases of ≲ 10−10 in ≲ 1ms. Such



On the conversion of orbital angles for extreme mass ratio inspirals 14

evaluation times are sufficiently quick for a single evaluation at the start of a trajectory

calculation to ensure consistent initial conditions when comparing between different

parameterisations to compute trajectories.

This numerical conversion may become too costly to apply to every single time-step

of a multi-year long EMRI trajectory for LISA data analysis. However, the main reasons

for doing so are to ensure agreement between different trajectory calculations (as was

done in the development of Refs. [32,34,36,47]), or to produce trajectory visualisations.

Neither of these use cases have the stringent runtime constraints of production level

waveform calculations for LISA data analysis.

We have made our implementations available in the KerrOrbitalAngleConversion

repository in Mathematica, C, and Python (via Cython) [50]. We will integrate

these conversions into tools already widely used by the community for ease of use.

The Mathematica implementation will form the basis for an implementation in the

KerrGeodesics package [51] which is part of the Black Hole Perturbation Toolkit [56].

The C implementation with Cython bindings for Python will form the basis of an

implementation in the FEW package.

Acknowledgments

This work makes use of the Black Hole Perturbation Toolkit. The authors thank

Leor Barak and Adam Pound for their detailed feedback on an early version of this

manuscript. OB is indebted to Leor Barack, Jonathan Gair, and Stas Babak for useful

discussions related to this project.

[1] N. Afshordi et al., “Waveform Modelling for the Laser Interferometer Space Antenna,” 11 2023.

[2] M. Colpi et al., “LISA Definition Study Report,” 2 2024.

[3] D. Mancieri, L. Broggi, M. Bonetti, and A. Sesana, “Hanging on the cliff: Emri formation

with local two-body relaxation and post-newtonian dynamics,” 2024. [Online]. Available:

https://arxiv.org/abs/2409.09122

[4] J. R. Gair, L. Barack, T. Creighton, C. Cutler, S. L. Larson, E. S. Phinney, and M. Vallisneri,

“Event rate estimates for LISA extreme mass ratio capture sources,” Class. Quant. Grav., vol. 21,

pp. S1595–S1606, 2004.

[5] S. Drasco and S. A. Hughes, “Gravitational wave snapshots of generic extreme mass ratio inspirals,”

Phys. Rev. D, vol. 73, no. 2, p. 024027, 2006, [Erratum: Phys.Rev.D 88, 109905 (2013), Erratum:

Phys.Rev.D 90, 109905 (2014)].

[6] P. Amaro-Seoane, J. R. Gair, M. Freitag, M. Coleman Miller, I. Mandel, C. J. Cutler, and

S. Babak, “Astrophysics, detection and science applications of intermediate- and extreme mass-

ratio inspirals,” Class. Quant. Grav., vol. 24, pp. R113–R169, 2007.

[7] J. R. Gair, E. E. Flanagan, S. Drasco, T. Hinderer, and S. Babak, “Forced motion near black

holes,” Phys. Rev. D, vol. 83, p. 044037, 2011.

[8] S. Babak, J. Gair, A. Sesana, E. Barausse, C. F. Sopuerta, C. P. L. Berry, E. Berti, P. Amaro-

Seoane, A. Petiteau, and A. Klein, “Science with the space-based interferometer LISA. V:

Extreme mass-ratio inspirals,” Phys. Rev. D, vol. 95, no. 10, p. 103012, 2017.

[9] L. Speri, S. Barsanti, A. Maselli, T. P. Sotiriou, N. Warburton, M. van de Meent,

A. J. K. Chua, O. Burke, and J. Gair, “Probing fundamental physics with extreme

https://arxiv.org/abs/2409.09122


On the conversion of orbital angles for extreme mass ratio inspirals 15

mass ratio inspirals: a full bayesian inference for scalar charge,” 2024. [Online]. Available:

https://arxiv.org/abs/2406.07607

[10] O. Burke, J. R. Gair, J. Simón, and M. C. Edwards, “Constraining the spin parameter of

near-extremal black holes using lisa,” Physical Review D, vol. 102, no. 12, Dec. 2020. [Online].

Available: http://dx.doi.org/10.1103/PhysRevD.102.124054

[11] N. Sago, T. Tanaka, W. Hikida, K. Ganz, and H. Nakano, “The Adiabatic evolution of orbital

parameters in the Kerr spacetime,” Prog. Theor. Phys., vol. 115, pp. 873–907, 2006.

[12] S. Isoyama, R. Fujita, H. Nakano, N. Sago, and T. Tanaka, ““Flux-balance formulae” for extreme

mass-ratio inspirals,” PTEP, vol. 2019, no. 1, p. 013E01, 2019.

[13] S. A. Hughes, “The Evolution of circular, nonequatorial orbits of Kerr black holes due to

gravitational wave emission,” Phys. Rev. D, vol. 61, no. 8, p. 084004, 2000, [Erratum:

Phys.Rev.D 63, 049902 (2001), Erratum: Phys.Rev.D 65, 069902 (2002), Erratum: Phys.Rev.D

67, 089901 (2003), Erratum: Phys.Rev.D 78, 109902 (2008), Erratum: Phys.Rev.D 90, 109904

(2014)].

[14] ——, “Evolution of circular, nonequatorial orbits of Kerr black holes due to gravitational wave

emission. II. Inspiral trajectories and gravitational wave forms,” Phys. Rev. D, vol. 64, p. 064004,

2001, [Erratum: Phys.Rev.D 88, 109902 (2013)].

[15] K. Glampedakis and D. Kennefick, “Zoom and whirl: Eccentric equatorial orbits around spinning

black holes and their evolution under gravitational radiation reaction,” Phys. Rev. D, vol. 66,

p. 044002, 2002.

[16] S. A. Hughes, S. Drasco, E. E. Flanagan, and J. Franklin, “Gravitational radiation reaction and

inspiral waveforms in the adiabatic limit,” Phys. Rev. Lett., vol. 94, p. 221101, 2005.

[17] S. A. Hughes, N. Warburton, G. Khanna, A. J. K. Chua, and M. L. Katz, “Adiabatic waveforms

for extreme mass-ratio inspirals via multivoice decomposition in time and frequency,” Phys.

Rev. D, vol. 103, no. 10, p. 104014, 2021, [Erratum: Phys.Rev.D 107, 089901 (2023)].

[18] S. Isoyama, R. Fujita, A. J. K. Chua, H. Nakano, A. Pound, and N. Sago, “Adiabatic Waveforms

from Extreme-Mass-Ratio Inspirals: An Analytical Approach,” Phys. Rev. Lett., vol. 128, no. 23,

p. 231101, 2022.

[19] Z. Nasipak, “Adiabatic gravitational waveform model for compact objects undergoing quasicircular

inspirals into rotating massive black holes,” Phys. Rev. D, vol. 109, no. 4, p. 044020, 2024.

[20] L. Barack and A. Pound, “Self-force and radiation reaction in general relativity,” Reports

on Progress in Physics, vol. 82, no. 1, p. 016904, Nov. 2018. [Online]. Available:

http://dx.doi.org/10.1088/1361-6633/aae552

[21] A. Pound and B. Wardell, Black Hole Perturbation Theory and Gravitational

Self-Force. Springer Singapore, 2021, p. 1–119. [Online]. Available: http:

//dx.doi.org/10.1007/978-981-15-4702-7 38-1

[22] T. Hinderer and E. E. Flanagan, “Two timescale analysis of extreme mass ratio inspirals in Kerr.

I. Orbital Motion,” Phys. Rev. D, vol. 78, p. 064028, 2008.

[23] J. Miller and A. Pound, “Two-timescale evolution of extreme-mass-ratio inspirals: waveform

generation scheme for quasicircular orbits in Schwarzschild spacetime,” Phys. Rev. D, vol. 103,

no. 6, p. 064048, 2021.

[24] A. Pound, “Second-order gravitational self-force,” Phys. Rev. Lett., vol. 109, p. 051101, 2012.

[25] A. Pound, B. Wardell, N. Warburton, and J. Miller, “Second-Order Self-Force Calculation of

Gravitational Binding Energy in Compact Binaries,” Phys. Rev. Lett., vol. 124, no. 2, p. 021101,

2020.

[26] N. Warburton, A. Pound, B. Wardell, J. Miller, and L. Durkan, “Gravitational-Wave Energy Flux

for Compact Binaries through Second Order in the Mass Ratio,” Phys. Rev. Lett., vol. 127,

no. 15, p. 151102, 2021.

[27] B. Wardell, A. Pound, N. Warburton, J. Miller, L. Durkan, and A. Le Tiec, “Gravitational

Waveforms for Compact Binaries from Second-Order Self-Force Theory,” Phys. Rev. Lett., vol.

130, no. 24, p. 241402, 2023.

https://arxiv.org/abs/2406.07607
http://dx.doi.org/10.1103/PhysRevD.102.124054
http://dx.doi.org/10.1088/1361-6633/aae552
http://dx.doi.org/10.1007/978-981-15-4702-7_38-1
http://dx.doi.org/10.1007/978-981-15-4702-7_38-1


On the conversion of orbital angles for extreme mass ratio inspirals 16

[28] O. Burke, G. A. Piovano, N. Warburton, P. Lynch, L. Speri, C. Kavanagh, B. Wardell, A. Pound,

L. Durkan, and J. Miller, “Assessing the importance of first postadiabatic terms for small-mass-

ratio binaries,” Phys. Rev. D, vol. 109, no. 12, p. 124048, 2024.

[29] A. Pound and E. Poisson, “Osculating orbits in Schwarzschild spacetime, with an application to

extreme mass-ratio inspirals,” Phys. Rev. D, vol. 77, p. 044013, 2008.

[30] M. Van De Meent and N. Warburton, “Fast Self-forced Inspirals,” Class. Quant. Grav., vol. 35,

no. 14, p. 144003, 2018.

[31] J. McCart, T. Osburn, and J. Y. J. Burton, “Highly eccentric extreme-mass-ratio-inspiral

waveforms via fast self-forced inspirals,” Phys. Rev. D, vol. 104, no. 8, p. 084050, 2021.

[32] P. Lynch, M. van de Meent, and N. Warburton, “Eccentric self-forced inspirals into a rotating

black hole,” Class. Quant. Grav., vol. 39, no. 14, p. 145004, 2022.

[33] P. Lynch, “Efficient trajectory calculations for extreme mass-ratio inspirals using near-identity

(averaging) transformations,” Ph.D. dissertation, University College Dublin, 9 2022.

[34] P. Lynch, M. van de Meent, and N. Warburton, “Self-forced inspirals with spin-orbit precession,”

Phys. Rev. D, vol. 109, no. 8, p. 084072, 2024.

[35] L. V. Drummond, A. G. Hanselman, D. R. Becker, and S. A. Hughes, “Extreme mass-ratio inspiral

of a spinning body into a Kerr black hole I: Evolution along generic trajectories,” 5 2023.

[36] P. Lynch, V. Witzany, M. van de Meent, and N. Warburton, “Fast inspirals and the treatment of

orbital resonances,” Class. Quant. Grav., vol. 41, no. 22, p. 225002, 2024.

[37] S. Drasco and S. A. Hughes, “Rotating black hole orbit functionals in the frequency domain,”

Phys. Rev. D, vol. 69, p. 044015, 2004.

[38] C. Darwin, “The Gravity Field of a Particle. II,” Proceedings of the Royal Society of London Series

A, vol. 263, no. 1312, pp. 39–50, Aug. 1961.

[39] N. Warburton, S. Akcay, L. Barack, J. R. Gair, and N. Sago, “Evolution of inspiral orbits around

a Schwarzschild black hole,” Phys. Rev. D, vol. 85, p. 061501, 2012.

[40] N. Warburton, T. Osburn, and C. R. Evans, “Evolution of small-mass-ratio binaries with a spinning

secondary,” Phys. Rev. D, vol. 96, no. 8, p. 084057, 2017.

[41] T. Osburn, N. Warburton, and C. R. Evans, “Highly eccentric inspirals into a black hole,” Phys.

Rev. D, vol. 93, no. 6, p. 064024, 2016.

[42] Y. Mino, “Perturbative approach to an orbital evolution around a supermassive black hole,” Phys.

Rev. D, vol. 67, p. 084027, 2003.

[43] R. Fujita and W. Hikida, “Analytical solutions of bound timelike geodesic orbits in Kerr

spacetime,” Class. Quant. Grav., vol. 26, p. 135002, 2009.

[44] W. Schmidt, “Celestial mechanics in Kerr space-time,” Class. Quant. Grav., vol. 19, p. 2743, 2002.

[45] M. L. Katz, A. J. K. Chua, L. Speri, N. Warburton, and S. A. Hughes, “Fast extreme-mass-ratio-

inspiral waveforms: New tools for millihertz gravitational-wave data analysis,” Phys. Rev. D,

vol. 104, no. 6, p. 064047, 2021.

[46] L. Speri, M. L. Katz, A. J. K. Chua, S. A. Hughes, N. Warburton, J. E. Thompson, C. E. A.

Chapman-Bird, and J. R. Gair, “Fast and Fourier: Extreme Mass Ratio Inspiral Waveforms in

the Frequency Domain,” 7 2023.

[47] L. V. Drummond, P. Lynch, A. G. Hanselman, D. R. Becker, and S. A. Hughes, “Extreme mass-

ratio inspiral and waveforms for a spinning body into a Kerr black hole via osculating geodesics

and near-identity transformations,” Phys. Rev. D, vol. 109, no. 6, p. 064030, 2024.

[48] J.-B. Bayle et al., “Lisa rosetta stone,” forthcoming.

[49] V. Witzany, “Action-angle coordinates for black-hole geodesics I: Spherically symmetric and

Schwarzschild,” 3 2022.

[50] Philip Lynch, “Hadoop.” [Online]. Available: https://github.com/Philip-Lynch/

KerrOrbitalAngleConversion

[51] N. Warburton, B. Wardell, O. Long, S. Upton, P. Lynch, Z. Nasipak, and L. C. Stein,

“Kerrgeodesics,” Jul. 2023. [Online]. Available: https://doi.org/10.5281/zenodo.8108265

[52] B. Carter, “Global structure of the Kerr family of gravitational fields,” Phys. Rev., vol. 174, pp.

https://github.com/Philip-Lynch/KerrOrbitalAngleConversion
https://github.com/Philip-Lynch/KerrOrbitalAngleConversion
https://doi.org/10.5281/zenodo.8108265


On the conversion of orbital angles for extreme mass ratio inspirals 17

1559–1571, 1968.

[53] G. A. Piovano, C. Pantelidou, J. Mac Uilliam, and V. Witzany, “Spinning particles near Kerr

black holes: Orbits and gravitational-wave fluxes through the Hamilton-Jacobi formalism,” 10

2024.

[54] M. van de Meent, “Analytic solutions for parallel transport along generic bound geodesics in Kerr

spacetime,” Class. Quant. Grav., vol. 37, no. 14, p. 145007, 2020.

[55] M. Galassi, GNU Scientific Library: Reference Manual, ser. GNU manual. Network Theory,

2009. [Online]. Available: https://books.google.de/books?id=CUuNPgAACAAJ

[56] “Black Hole Perturbation Toolkit,” (bhptoolkit.org).

Appendix A. Quasi-Keplerian angles to Mino time action angles in the

limiting cases

In order to demonstrate that the QK angle to MTAA conversions are well behaved

in their respective limiting cases, we have to derive the conversion in a different way.

Starting with Eq. (11b) and using the chain rule along with Eqs. (10), one obtains:

dqi
dλ

=
∂qi
∂ψi

dψi
dλ

=
∂qi
∂ψi

fi = Υi, (A.1)

where ψi = (ψ, χ). Rearranging the above and integrating with respect to ψi gives us

qi =

∫ ψi

0

∂qi
∂ψi

dψ′
i =

∫ ψi

0

Υi

fi(ψ′
i)
dψ′

i. (A.2)

Integrating Eq. (A.2) numerically recovers the same values as Eqs. (20b) and (21b).

Appendix A.1. Radial conversion in the circular orbit limit

Obtaining an analytic solution to the radial component of Eq. (A.2) has proven illusive.

For this analysis we only care about its behaviour as e → 0. As such, we expand the

integrand to first order in e and obtain:

qr =

∫ ψ

0

(
1 +

(p(̊r3 + r̊4)− 2̊r3r̊3) e cosψ
′

2(p− r̊3)(p− r̊4)
+O(e2)

)
dψ′

= ψ +
(p(̊r3 + r̊4)− 2̊r3r̊3) e sinψ

′

2(p− r̊3)(p− r̊4)
+O(e2),

(A.3)

where r̊3 and r̊4 denotes r3 and r4 evaluated at e = 0. This is clearly well behaved in

the e→ 0 limit and results in lime→0 qr = ψ.

Appendix A.2. Polar conversion in the equatorial orbit limit

The polar component of Eq. (A.2) does have an analytic solution in terms of Jacobi

elliptic integrals given by

qθ =
πz+F (χ|(βz2−/(βz2− − z2+)))

2
√
z2+ − βz2−K(kz)

(A.4)

This function has a well defined limit in the equatorial plane when z− → 0, which gives

us: limz−→0 qθ = χ.

https://books.google.de/books?id=CUuNPgAACAAJ
http://bhptoolkit.org/

	Introduction
	Geodesics in Kerr spacetime
	Constants of Motion
	Quasi-Keplerian parameterisation
	Mino time action angle parametrisation
	Boyer-Lindquist time action angle parameterisation

	Angle Conversions
	Quasi-Keplerian to Mino-time action angles
	Mino-time action angles to Boyer-Lindquist action angles
	Quasi-Keplerian to Boyer-Lindquist action angles

	Results
	Discussion
	Quasi-Keplerian angles to Mino time action angles in the limiting cases
	Radial conversion in the circular orbit limit
	Polar conversion in the equatorial orbit limit


